
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Deepmind PerceiverIO on GPU &#8212; Ivy Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=7c465b21" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Inter:100,200,300,regular,500,600,700,800,900" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=3ce10a4d"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=4ea706d9"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-QP5BET66XH"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-QP5BET66XH');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-QP5BET66XH');
            </script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'demos/wip/deepmind_perceiverio';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.2';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://unify.ai/docs/versions/ivy.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'dev';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <script src="../../_static/js/kapa.ai.js?v=996880f3"></script>
    <link rel="icon" href="https://github.com/unifyai/unifyai.github.io/blob/main/img/externally_linked/ivy_logo_only.png?raw=true"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../index.html">
                        Home
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../overview/get_started.html">
                        Get Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../quickstart.html">
                        Quickstart
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../learn_the_basics.html">
                        Learn the basics
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../guides.html">
                        Guides
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../examples_and_demos.html">
                        Examples and Demos
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../overview/motivation.html">
                        Motivation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../overview/related_work.html">
                        Related Work
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../overview/design.html">
                        Design
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../overview/contributing.html">
                        Contributing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../overview/volunteer_ranks.html">
                        Contributor Leaderboard
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../overview/deep_dive.html">
                        Deep Dive
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../overview/glossary.html">
                        Glossary
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../overview/faq.html">
                        FAQ
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../overview/one_liners.html">
                        One liners
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/functional/ivy.functional.ivy.html">
                        Functions
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/data_classes/ivy.data_classes.html">
                        Data classes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/ivy.stateful.html">
                        Framework classes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/ivy.utils.html">
                        Utils
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/ivy_tests.test_ivy.helpers.html">
                        Testing
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Deepmind...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a href="https://colab.research.google.com/github/unifyai/demos/blob/main/wip/deepmind_perceiverio.ipynb" target="_blank">
    <img src="https://colab.research.google.com/assets/colab-badge.svg">
</a> <a href="https://github.com/unifyai/demos/blob/main/wip/deepmind_perceiverio.ipynb" target="_blank">
    <img src="https://badgen.net/badge/icon/github?icon=github&label">
</a></p>
<section id="Deepmind-PerceiverIO-on-GPU">
<h1>Deepmind PerceiverIO on GPU<a class="headerlink" href="#Deepmind-PerceiverIO-on-GPU" title="Link to this heading">#</a></h1>
<section id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Link to this heading">#</a></h2>
<p>This notebook presents a demonstration of how to run the PercieverIO model on GPU using any of the following backends currently supported by ivy (numpy, torch, tensorflow and JAX). To find out more about ivy please feel free to checkout the ivy repo <a class="github reference external" href="https://github.com/unifyai/ivy">unifyai/ivy</a> as well as the docs <a class="reference external" href="https://lets-unify.ai/ivy/index.html">https://lets-unify.ai/ivy/index.html</a>. Contributions are highly welcomed and you can interact with our community as well on discord <a class="reference external" href="https://discord.com/invite/G4aR9Q7DTN">https://discord.com/invite/G4aR9Q7DTN</a>.</p>
<section id="Install-Python3.8-and-setup-the-kernel">
<h3>Install Python3.8 and setup the kernel<a class="headerlink" href="#Install-Python3.8-and-setup-the-kernel" title="Link to this heading">#</a></h3>
<p>NOTE: After running the cell below, you’ll need to restart the runtime for the newly installed kernel to work.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step1</span>
<span class="err">!</span><span class="n">printf</span> <span class="s2">&quot;#Step1 start Download python3.8packages(tar.gz) of Share File from GoogleDrive</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="err">!</span><span class="n">printf</span> <span class="s2">&quot;10_wfp1U4rMzc20eiGNrdQa9V2S9ByJwV&quot;</span> <span class="o">&gt;</span> <span class="o">./</span><span class="n">FILE_ID</span> <span class="p">;</span>\
 <span class="n">printf</span> <span class="s2">&quot;wget  -O `cat ./FILE_ID`.tar.gz </span><span class="se">\&quot;</span><span class="s2">https://drive.google.com/uc?export=download&amp;id=`cat ./FILE_ID`&amp;confirm=t&amp;&quot;</span><span class="o">|</span><span class="n">tee</span>  <span class="o">./</span><span class="n">FILE_ID_WGET_CMD</span>  <span class="p">;</span>\
  <span class="n">printf</span> <span class="s2">&quot;`wget -q &quot;</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">drive</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">uc</span><span class="err">?</span><span class="n">export</span><span class="o">=</span><span class="n">download</span><span class="o">&amp;</span><span class="nb">id</span><span class="o">=</span>\<span class="err">`</span><span class="n">cat</span> <span class="o">./</span><span class="n">FILE_ID</span>\<span class="err">`</span><span class="s2">&quot; -O - | perl -pe &#39;s/</span><span class="se">\r</span><span class="s2">*</span><span class="se">\n</span><span class="s2">//g&#39; | perl -pe &#39;s/^.*(uuid\=[^</span><span class="se">\&quot;</span><span class="s2">]+)</span><span class="se">\&quot;</span><span class="s2">.*$/$</span><span class="si">{1}</span><span class="s2">/g&#39;`&quot;</span><span class="o">|</span><span class="n">tee</span> <span class="o">-</span><span class="n">a</span> <span class="o">./</span><span class="n">FILE_ID_WGET_CMD</span>  <span class="p">;</span>\
    <span class="n">printf</span> <span class="s2">&quot;&amp;uc-download-link=Download anyway</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">|</span><span class="n">tee</span> <span class="o">-</span><span class="n">a</span> <span class="o">./</span><span class="n">FILE_ID_WGET_CMD</span> <span class="p">;</span>\
      <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span> <span class="o">./</span><span class="n">FILE_ID_WGET_CMD</span>
<span class="err">!</span><span class="n">printf</span> <span class="s2">&quot;#Step1 End Download python3.8packages(tar.gz) of Share File from GoogleDrive</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="c1"># Step2 Install python3.8 interpreter and python3-pip</span>
<span class="err">!</span><span class="n">printf</span> <span class="s2">&quot;Step2 Start python3.8 interpreter and install python3-pip</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="err">!</span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">python3</span><span class="mf">.8</span>
<span class="err">!</span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">yf</span> <span class="n">python3</span><span class="o">-</span><span class="n">pip</span>
<span class="err">!</span><span class="n">printf</span> <span class="s2">&quot;Step2 End install python3.8 interpreter and python3-pip</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="c1"># Step3</span>
<span class="err">!</span><span class="n">printf</span> <span class="s2">&quot;#Step3 Start Create ./dist-packages in the current directory, extract python3.8packages (tar.gz), and delete</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="err">!</span><span class="n">mkdir</span> <span class="o">./</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span>
<span class="err">!</span><span class="n">tar</span> <span class="n">xvzf</span> <span class="err">`</span><span class="n">cat</span> <span class="o">./</span><span class="n">FILE_ID</span><span class="err">`</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span> <span class="o">-</span><span class="n">C</span> <span class="o">./</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span>
<span class="err">!</span><span class="n">rm</span> <span class="err">`</span><span class="n">cat</span> <span class="o">./</span><span class="n">FILE_ID</span><span class="err">`</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="err">!</span><span class="n">printf</span> <span class="s2">&quot;#Step3 End Create ./dist-packages in the current directory, extract python3.8packages (tar.gz), and delete</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="c1"># Step4</span>
<span class="err">!</span><span class="n">printf</span> <span class="s2">&quot;# Step4 Start symlink python3.7 google* package to unzipped python3.8 package directory</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="err">!</span><span class="n">rm</span> <span class="o">-</span><span class="n">fr</span> <span class="o">/</span><span class="n">content</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.8</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">google</span><span class="o">*</span>
<span class="err">!</span><span class="n">ls</span> <span class="o">-</span><span class="n">d</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.7</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">google</span><span class="o">*</span> \
  <span class="o">|</span> <span class="n">perl</span> <span class="o">-</span><span class="n">pe</span> <span class="s1">&#39;s/^(.+)$/sudo ln -sf $</span><span class="si">{1}</span><span class="s1"> \/content\/dist-packages\/usr\/local\/lib\/python3.8\/dist-packages\//g&#39;</span> \
    <span class="o">|/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span> <span class="o">-</span>
<span class="err">!</span><span class="n">ls</span> <span class="o">-</span><span class="n">la</span> <span class="o">/</span><span class="n">content</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.8</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">google</span><span class="o">*</span>
<span class="err">!</span><span class="n">printf</span> <span class="s2">&quot;# Step4 End symlink the python3.7 google* package to the unzipped python3.8 package directory</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="c1"># Step5</span>
<span class="err">!</span><span class="n">printf</span> <span class="s2">&quot;# Step5 Start and replace the unzipped python3.8 package directory with a regular python3.8 package directory with a symlink</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="err">!</span><span class="n">rm</span> <span class="o">-</span><span class="n">fr</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.8</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span>
<span class="err">!</span><span class="n">sudo</span> <span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">content</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.8</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.8</span><span class="o">/</span>
<span class="err">!</span><span class="n">printf</span> <span class="s2">&quot;# Step5 End And symlink the unzipped python3.8 package directory to the regular python3.8 package directory</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="c1"># Step6</span>
<span class="err">!</span><span class="n">printf</span> <span class="s2">&quot;# Step6 Start change python interpreter to 3.8</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="err">!</span><span class="n">printf</span> <span class="s2">&quot;python3.8 restart step 4</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="err">!</span><span class="n">sudo</span> <span class="n">ln</span> <span class="o">-</span><span class="n">sf</span> <span class="err">`</span><span class="n">which</span> <span class="n">python3</span><span class="mf">.8</span><span class="err">`</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">alternatives</span><span class="o">/</span><span class="n">python3</span>
<span class="err">!</span><span class="n">python</span> <span class="o">--</span><span class="n">version</span>
<span class="err">!</span><span class="n">printf</span> <span class="s2">&quot;# Step6 End Change python interpreter to 3.8</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="c1"># Run ipkykernel with Step7 3.8 python, name it &quot;engbjapanpython3.8&quot; and install the runtime separately</span>
<span class="err">!</span><span class="n">printf</span> <span class="s2">&quot;#Step7 Start Name engbjapanpython3.8 and start runtime (Python 3.8) ipykernel</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="err">!</span><span class="n">sudo</span> <span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">ipykernel</span> <span class="n">install</span> <span class="o">--</span><span class="n">name</span> <span class="s2">&quot;engbjapanpython3.8&quot;</span> <span class="o">--</span><span class="n">user</span>
<span class="err">!</span><span class="n">printf</span> <span class="s2">&quot;#Step7 End Start the runtime (Python 3.8) ipykernel named engbjapanpython3.8</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="err">!</span><span class="n">printf</span> <span class="s2">&quot;When everything is finished, please execute ``Change runtime type and reconnect&#39;&#39;</span><span class="se">\n</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User Current Version:-&quot;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
User Current Version:- 3.8.15 (default, Oct 12 2022, 19:14:39)
[GCC 7.5.0]
</pre></div></div>
</div>
</section>
<section id="Clone-the-ivy-and-ivy-models-repo">
<h3>Clone the ivy and ivy-models repo<a class="headerlink" href="#Clone-the-ivy-and-ivy-models-repo" title="Link to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">git</span> <span class="n">lfs</span> <span class="n">clone</span> <span class="o">--</span><span class="n">depth</span> <span class="mi">1</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">unifyai</span><span class="o">/</span><span class="n">models</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">git</span> <span class="n">clone</span> <span class="o">--</span><span class="n">depth</span> <span class="mi">1</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">unifyai</span><span class="o">/</span><span class="n">ivy</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</div>
</section>
<section id="Install-ivy-and-ivy_models-from-the-repos">
<h3>Install ivy and ivy_models from the repos<a class="headerlink" href="#Install-ivy-and-ivy_models-from-the-repos" title="Link to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">models</span><span class="o">/</span> <span class="o">--</span><span class="n">upgrade</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">ivy</span><span class="o">/</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># install the optional requirements to use JAX, tensorflow and torch backends</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">ivy</span><span class="o">/</span><span class="n">requirements</span><span class="o">/</span><span class="n">optional</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install jaxlib with with the corresponding CUDA version.</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span>  <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">storage</span><span class="o">.</span><span class="n">googleapis</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">jax</span><span class="o">-</span><span class="n">releases</span><span class="o">/</span><span class="n">cuda11</span><span class="o">/</span><span class="n">jaxlib</span><span class="o">-</span><span class="mf">0.3.14</span><span class="o">+</span><span class="n">cuda11</span><span class="o">.</span><span class="n">cudnn805</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">manylinux2014_x86_64</span><span class="o">.</span><span class="n">whl</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Run-the-demo...">
<h2>Run the demo…<a class="headerlink" href="#Run-the-demo..." title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/local/bin/python3.8</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">ivy</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="kn">from</span> <span class="nn">ivy_models.transformers.helpers</span> <span class="kn">import</span> <span class="n">FeedForward</span><span class="p">,</span> <span class="n">PreNorm</span>
<span class="kn">from</span> <span class="nn">ivy_models.transformers.perceiver_io</span> <span class="kn">import</span> <span class="n">PerceiverIOSpec</span><span class="p">,</span> <span class="n">PerceiverIO</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fetch sample images for inference</span>
<span class="err">!</span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ogbanugot</span><span class="o">/</span><span class="n">imagenet</span><span class="o">-</span><span class="n">samples</span><span class="o">.</span><span class="n">git</span>

<span class="c1">#Fetch the class labels</span>
<span class="err">!</span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">xmartlabs</span><span class="o">/</span><span class="n">caffeflow</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fetch_classes</span><span class="p">():</span>
  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/content/caffeflow/examples/imagenet/imagenet-classes.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">class_labels</span><span class="p">:</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">class_labels</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">classes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
          <span class="n">classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">classes</span>

<span class="n">classes</span> <span class="o">=</span> <span class="n">fetch_classes</span><span class="p">()</span>
<span class="n">ground_truth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">127</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">path_to_images</span> <span class="o">=</span> <span class="s2">&quot;/content/imagenet-samples/&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Helpers</span>

<span class="k">def</span> <span class="nf">get_image</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
  <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">))</span>
  <span class="k">if</span> <span class="n">display</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">img</span>

  <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
  <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span>
  <span class="n">img</span> <span class="o">/=</span> <span class="mi">255</span>
  <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
    <span class="n">img</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">-=</span> <span class="n">mean</span>
    <span class="n">img</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">/=</span> <span class="n">std</span>
  <span class="k">return</span> <span class="n">img</span>


<span class="k">def</span> <span class="nf">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>

<span class="k">def</span> <span class="nf">show_results</span><span class="p">(</span><span class="n">path_to_images</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="n">ground_truth</span><span class="p">):</span>
  <span class="c1"># plot the images in the batch, along with predicted and true labels</span>
  <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
  <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path_to_images</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.JPEG&quot;</span><span class="p">)):</span>
      <span class="n">this_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path_to_images</span><span class="p">)</span>
      <span class="n">image</span> <span class="o">=</span> <span class="n">get_image</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">this_dir</span><span class="p">,</span> <span class="n">image</span><span class="p">))</span>
      <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>
      <span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
      <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">classes</span><span class="p">[</span><span class="n">preds</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">classes</span><span class="p">[</span><span class="n">ground_truth</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span>
                  <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;green&quot;</span> <span class="k">if</span> <span class="n">preds</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">==</span><span class="n">ground_truth</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;red&quot;</span><span class="p">))</span>
      <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Perceiver IO #</span>
<span class="c1"># -------------#</span>
<span class="k">def</span> <span class="nf">perceiver_io_img_classification</span><span class="p">(</span><span class="n">path_to_images</span><span class="p">,</span> <span class="n">normalize_images</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">batch_shape</span><span class="p">,</span> <span class="n">img_dims</span><span class="p">,</span> <span class="n">queries_dim</span><span class="p">,</span> <span class="n">learn_query</span><span class="p">,</span>
                                         <span class="n">load_weights</span><span class="p">):</span>
    <span class="c1"># params</span>
    <span class="n">input_dim</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">num_input_axes</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">output_dim</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">network_depth</span> <span class="o">=</span> <span class="mi">8</span> <span class="k">if</span> <span class="n">load_weights</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="n">num_lat_att_per_layer</span> <span class="o">=</span> <span class="mi">6</span> <span class="k">if</span> <span class="n">load_weights</span> <span class="k">else</span> <span class="mi">1</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">PerceiverIO</span><span class="p">(</span><span class="n">PerceiverIOSpec</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">input_dim</span><span class="p">,</span>
                                        <span class="n">num_input_axes</span><span class="o">=</span><span class="n">num_input_axes</span><span class="p">,</span>
                                        <span class="n">output_dim</span><span class="o">=</span><span class="n">output_dim</span><span class="p">,</span>
                                        <span class="n">queries_dim</span><span class="o">=</span><span class="n">queries_dim</span><span class="p">,</span>
                                        <span class="n">network_depth</span><span class="o">=</span><span class="n">network_depth</span><span class="p">,</span>
                                        <span class="n">learn_query</span><span class="o">=</span><span class="n">learn_query</span><span class="p">,</span>
                                        <span class="n">query_shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                        <span class="n">num_fourier_freq_bands</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
                                        <span class="n">num_lat_att_per_layer</span><span class="o">=</span><span class="n">num_lat_att_per_layer</span><span class="p">,</span>
                                        <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">))</span>

    <span class="n">this_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="s2">&quot;models/&quot;</span><span class="p">)</span>
    <span class="c1"># maybe load weights</span>
    <span class="k">if</span> <span class="n">load_weights</span><span class="p">:</span>
        <span class="n">weight_fpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">this_dir</span><span class="p">,</span> <span class="s1">&#39;ivy_models/transformers/pretrained_weights/perceiver_io.pickled&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">weight_fpath</span><span class="p">)</span>
        <span class="c1"># noinspection PyBroadException</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Container</span><span class="o">.</span><span class="n">from_disk_as_pickled</span><span class="p">(</span><span class="n">weight_fpath</span><span class="p">)</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># If git large-file-storage is not enabled (for example when testing in github actions workflow), then the</span>
            <span class="c1">#  code will fail here. A placeholder file does exist, but the file cannot be loaded as pickled variables.</span>
            <span class="k">raise</span>
        <span class="c1"># noinspection PyUnboundLocalVariable</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">PerceiverIO</span><span class="p">(</span><span class="n">PerceiverIOSpec</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">input_dim</span><span class="p">,</span>
                                            <span class="n">num_input_axes</span><span class="o">=</span><span class="n">num_input_axes</span><span class="p">,</span>
                                            <span class="n">output_dim</span><span class="o">=</span><span class="n">output_dim</span><span class="p">,</span>
                                            <span class="n">queries_dim</span><span class="o">=</span><span class="n">queries_dim</span><span class="p">,</span>
                                            <span class="n">network_depth</span><span class="o">=</span><span class="n">network_depth</span><span class="p">,</span>
                                            <span class="n">learn_query</span><span class="o">=</span><span class="n">learn_query</span><span class="p">,</span>
                                            <span class="n">query_shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                            <span class="n">max_fourier_freq</span><span class="o">=</span><span class="n">img_dims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                            <span class="n">num_fourier_freq_bands</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
                                            <span class="n">num_lat_att_per_layer</span><span class="o">=</span><span class="n">num_lat_att_per_layer</span><span class="p">,</span>
                                            <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">),</span> <span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>

    <span class="n">logits</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path_to_images</span><span class="p">):</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.JPEG&quot;</span><span class="p">)):</span>
        <span class="c1"># inputs</span>
        <span class="n">this_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="s2">&quot;/content/imagenet-samples/&quot;</span><span class="p">)</span>

        <span class="n">img</span> <span class="o">=</span> <span class="n">get_image</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">this_dir</span><span class="p">,</span> <span class="n">image</span><span class="p">),</span> <span class="kc">False</span><span class="p">,</span> <span class="n">normalize_images</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="p">[</span><span class="kc">None</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
        <span class="n">queries</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">learn_query</span> <span class="k">else</span> <span class="n">ivy</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">batch_shape</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">queries_dim</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
        <span class="c1"># output</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">queries</span><span class="o">=</span><span class="n">queries</span><span class="p">)</span>
        <span class="n">logits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ivy</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">logits</span>
</pre></div>
</div>
</div>
<section id="...with-torch-backend">
<h3>…with torch backend<a class="headerlink" href="#...with-torch-backend" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ivy</span><span class="o">.</span><span class="n">set_backend</span><span class="p">(</span><span class="s2">&quot;torch&quot;</span><span class="p">)</span>
<span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;gpu:0&quot;</span>
<span class="n">batch_shape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">img_dims</span> <span class="o">=</span> <span class="p">[</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">]</span>
<span class="n">queries_dim</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">learn_query</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span>
<span class="n">load_weights</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">normalize_images</span><span class="o">=</span><span class="kc">False</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">perceiver_io_img_classification</span><span class="p">(</span><span class="n">path_to_images</span><span class="p">,</span> <span class="n">normalize_images</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">batch_shape</span><span class="p">,</span> <span class="n">img_dims</span><span class="p">,</span> <span class="n">queries_dim</span><span class="p">,</span> <span class="n">learn_query</span><span class="p">,</span>
                                         <span class="n">load_weights</span><span class="p">)</span>

<span class="n">show_results</span><span class="p">(</span><span class="n">path_to_images</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="n">ground_truth</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/demos_wip_deepmind_perceiverio_20_0.png" src="../../_images/demos_wip_deepmind_perceiverio_20_0.png" />
</div>
</div>
</section>
<section id="....with-tensorflow-backend">
<h3>….with tensorflow backend<a class="headerlink" href="#....with-tensorflow-backend" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ivy</span><span class="o">.</span><span class="n">set_backend</span><span class="p">(</span><span class="s2">&quot;tensorflow&quot;</span><span class="p">)</span>
<span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;gpu:0&quot;</span>
<span class="n">batch_shape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">img_dims</span> <span class="o">=</span> <span class="p">[</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">]</span>
<span class="n">queries_dim</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">learn_query</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span>
<span class="n">load_weights</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">normalize_images</span><span class="o">=</span><span class="kc">False</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">perceiver_io_img_classification</span><span class="p">(</span><span class="n">path_to_images</span><span class="p">,</span> <span class="n">normalize_images</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">batch_shape</span><span class="p">,</span> <span class="n">img_dims</span><span class="p">,</span> <span class="n">queries_dim</span><span class="p">,</span> <span class="n">learn_query</span><span class="p">,</span>
                                         <span class="n">load_weights</span><span class="p">)</span>

<span class="n">show_results</span><span class="p">(</span><span class="n">path_to_images</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="n">ground_truth</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2022-11-03 20:04:33.817437: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/demos_wip_deepmind_perceiverio_22_1.png" src="../../_images/demos_wip_deepmind_perceiverio_22_1.png" />
</div>
</div>
</section>
<section id="...with-jax-backend">
<h3>…with jax backend<a class="headerlink" href="#...with-jax-backend" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ivy</span><span class="o">.</span><span class="n">set_backend</span><span class="p">(</span><span class="s2">&quot;jax&quot;</span><span class="p">)</span>
<span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;gpu:0&quot;</span>
<span class="n">batch_shape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">img_dims</span> <span class="o">=</span> <span class="p">[</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">]</span>
<span class="n">queries_dim</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">learn_query</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span>
<span class="n">load_weights</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">normalize_images</span><span class="o">=</span><span class="kc">False</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">perceiver_io_img_classification</span><span class="p">(</span><span class="n">path_to_images</span><span class="p">,</span> <span class="n">normalize_images</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">batch_shape</span><span class="p">,</span> <span class="n">img_dims</span><span class="p">,</span> <span class="n">queries_dim</span><span class="p">,</span> <span class="n">learn_query</span><span class="p">,</span>
                                         <span class="n">load_weights</span><span class="p">)</span>

<span class="n">show_results</span><span class="p">(</span><span class="n">path_to_images</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="n">ground_truth</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/demos_wip_deepmind_perceiverio_24_0.png" src="../../_images/demos_wip_deepmind_perceiverio_24_0.png" />
</div>
</div>
</section>
<section id="...with-numpy-backend">
<h3>…with numpy backend<a class="headerlink" href="#...with-numpy-backend" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ivy</span><span class="o">.</span><span class="n">set_backend</span><span class="p">(</span><span class="s2">&quot;numpy&quot;</span><span class="p">)</span>
<span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span>
<span class="n">batch_shape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">img_dims</span> <span class="o">=</span> <span class="p">[</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">]</span>
<span class="n">queries_dim</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">learn_query</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span>
<span class="n">load_weights</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">normalize_images</span><span class="o">=</span><span class="kc">False</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">perceiver_io_img_classification</span><span class="p">(</span><span class="n">path_to_images</span><span class="p">,</span> <span class="n">normalize_images</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">batch_shape</span><span class="p">,</span> <span class="n">img_dims</span><span class="p">,</span> <span class="n">queries_dim</span><span class="p">,</span> <span class="n">learn_query</span><span class="p">,</span>
                                         <span class="n">load_weights</span><span class="p">)</span>

<span class="n">show_results</span><span class="p">(</span><span class="n">path_to_images</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="n">ground_truth</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
WARNING:root:NumPy does not support autograd, declaring a &#39;variable&#39; is identical to declaring an &#39;array&#39; when using numpy backend.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/demos_wip_deepmind_perceiverio_26_1.png" src="../../_images/demos_wip_deepmind_perceiverio_26_1.png" />
</div>
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Install-Python3.8-and-setup-the-kernel">Install Python3.8 and setup the kernel</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Clone-the-ivy-and-ivy-models-repo">Clone the ivy and ivy-models repo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Install-ivy-and-ivy_models-from-the-repos">Install ivy and ivy_models from the repos</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Run-the-demo...">Run the demo…</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#...with-torch-backend">…with torch backend</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#....with-tensorflow-backend">….with tensorflow backend</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#...with-jax-backend">…with jax backend</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#...with-numpy-backend">…with numpy backend</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Transpile AI.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>

<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Arrays &#8212; Ivy Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=7c465b21" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Inter:100,200,300,regular,500,600,700,800,900" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=3ce10a4d"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=4ea706d9"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-QP5BET66XH"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-QP5BET66XH');
            </script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-QP5BET66XH');
            </script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'overview/deep_dive/arrays';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.2';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://unify.ai/docs/versions/ivy.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'dev';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <script src="../../_static/js/kapa.ai.js?v=996880f3"></script>
    <link rel="icon" href="https://github.com/unifyai/unifyai.github.io/blob/main/img/externally_linked/ivy_logo_only.png?raw=true"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Containers" href="containers.html" />
    <link rel="prev" title="Backend Setting" href="backend_setting.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../index.html">
                        Home
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../get_started.html">
                        Get Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../demos/quickstart.html">
                        Quickstart
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../demos/learn_the_basics.html">
                        Learn the basics
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../demos/guides.html">
                        Guides
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../demos/examples_and_demos.html">
                        Examples and Demos
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../motivation.html">
                        Motivation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../related_work.html">
                        Related Work
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../design.html">
                        Design
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing.html">
                        Contributing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../volunteer_ranks.html">
                        Contributor Leaderboard
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../deep_dive.html">
                        Deep Dive
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../glossary.html">
                        Glossary
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../faq.html">
                        FAQ
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../one_liners.html">
                        One liners
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/functional/ivy.functional.ivy.html">
                        Functions
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/data_classes/ivy.data_classes.html">
                        Data classes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/ivy.stateful.html">
                        Framework classes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/ivy.utils.html">
                        Utils
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../docs/ivy_tests.test_ivy.helpers.html">
                        Testing
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../deep_dive.html" class="nav-link">Deep Dive</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Arrays</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="arrays">
<h1>Arrays<a class="headerlink" href="#arrays" title="Link to this heading">#</a></h1>
<p>There are two types of arrays in Ivy, there is the <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.NativeArray</span></code> and also the <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.Array</span></code>.</p>
<section id="native-array">
<h2>Native Array<a class="headerlink" href="#native-array" title="Link to this heading">#</a></h2>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.NativeArray</span></code> is simply a placeholder class for a backend-specific array class, such as <code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tf.Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">jaxlib.xla_extension.DeviceArray</span></code>.</p>
<p>When no framework is set, this is an <a class="reference external" href="https://github.com/unifyai/ivy/blob/529c8c0f128ff28331da7c8f52912d777d786cbe/ivy/__init__.py#L8">empty class</a>.
When a framework is set, this is <a class="reference external" href="https://github.com/unifyai/ivy/blob/529c8c0f128ff28331da7c8f52912d777d786cbe/ivy/functional/backends/torch/__init__.py#L11">overwritten</a> with the backend-specific array class.</p>
</section>
<section id="ivy-array">
<h2>Ivy Array<a class="headerlink" href="#ivy-array" title="Link to this heading">#</a></h2>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.Array</span></code> is a simple wrapper class, which wraps around the <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.NativeArray</span></code>, storing it in <a class="reference external" href="https://github.com/unifyai/ivy/blob/529c8c0f128ff28331da7c8f52912d777d786cbe/ivy/array/__init__.py#L89">self._data</a>.</p>
<p>All functions in the Ivy functional API which accept <em>at least one array argument</em> in the input are implemented as instance methods in the <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.Array</span></code> class.
The only exceptions to this are functions in the <a class="reference external" href="https://github.com/unifyai/ivy/blob/906ddebd9b371e7ae414cdd9b4bf174fd860efc0/ivy/functional/ivy/nest.py">nest</a> module and the <a class="reference external" href="https://github.com/unifyai/ivy/blob/906ddebd9b371e7ae414cdd9b4bf174fd860efc0/ivy/functional/ivy/meta.py">meta</a> module, which have no instance method implementations.</p>
<p>The organization of these instance methods follows the same organizational structure as the files in the functional API.
The <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.Array</span></code> class <a class="reference external" href="https://github.com/unifyai/ivy/blob/8cbffbda9735cf16943f4da362ce350c74978dcb/ivy/array/__init__.py#L44">inherits</a> from many category-specific array classes, such as <a class="reference external" href="https://github.com/unifyai/ivy/blob/529c8c0f128ff28331da7c8f52912d777d786cbe/ivy/array/elementwise.py#L12">ArrayWithElementwise</a>, each of which implements the category-specific instance methods.</p>
<p>Each instance method simply calls the functional API function internally, but passes in <code class="code docutils literal notranslate"><span class="pre">self._data</span></code> as the first <em>array</em> argument.
<a class="reference external" href="https://github.com/unifyai/ivy/blob/63d9c26acced9ef40e34f7b4fc1c1a75017f9c69/ivy/array/elementwise.py#L22">ivy.Array.add</a> is a good example.
However, it’s important to bear in mind that this is <em>not necessarily the first argument</em>, although in most cases it will be.
We also <strong>do not</strong> set the <code class="code docutils literal notranslate"><span class="pre">out</span></code> argument to <code class="code docutils literal notranslate"><span class="pre">self</span></code> for instance methods.
If the only array argument is the <code class="code docutils literal notranslate"><span class="pre">out</span></code> argument, then we do not implement this instance method.
For example, we do not implement an instance method for <a class="reference external" href="https://github.com/unifyai/ivy/blob/1dba30aae5c087cd8b9ffe7c4b42db1904160873/ivy/functional/ivy/creation.py#L116">ivy.zeros</a>.</p>
<p>Given the simple set of rules which underpin how these instance methods should all be implemented, if a source-code implementation is not found, then this instance method is added <a class="reference external" href="https://github.com/unifyai/ivy/blob/529c8c0f128ff28331da7c8f52912d777d786cbe/ivy/__init__.py#L148">programmatically</a>.
This serves as a helpful backup in cases where some methods are accidentally missed out.</p>
<p>The benefit of the source code implementations is that this makes the code much more readable, with important methods not being entirely absent from the code.
It also enables other helpful perks, such as auto-completions in the IDE etc.</p>
<p>Most special methods also simply wrap a corresponding function in the functional API, as <a class="reference external" href="https://data-apis.org/array-api/latest/API_specification/array_object.html">is the case</a> in the Array API Standard.
Examples include <a class="reference external" href="https://github.com/unifyai/ivy/blob/e4d9247266f5d99faad59543923bb24b88a968d9/ivy/array/__init__.py#L291">__add__</a>, <a class="reference external" href="https://github.com/unifyai/ivy/blob/e4d9247266f5d99faad59543923bb24b88a968d9/ivy/array/__init__.py#L299">__sub__</a>, <a class="reference external" href="https://github.com/unifyai/ivy/blob/e4d9247266f5d99faad59543923bb24b88a968d9/ivy/array/__init__.py#L307">__mul__</a> and <a class="reference external" href="https://github.com/unifyai/ivy/blob/e4d9247266f5d99faad59543923bb24b88a968d9/ivy/array/__init__.py#L319">__truediv__</a> which directly call <a class="reference internal" href="../../docs/functional/ivy/elementwise/ivy.functional.ivy.elementwise.add.html#ivy.add" title="ivy.add"><code class="xref py py-func docutils literal notranslate"><span class="pre">ivy.add()</span></code></a>, <a class="reference internal" href="../../docs/functional/ivy/elementwise/ivy.functional.ivy.elementwise.subtract.html#ivy.subtract" title="ivy.subtract"><code class="xref py py-func docutils literal notranslate"><span class="pre">ivy.subtract()</span></code></a>, <a class="reference internal" href="../../docs/functional/ivy/elementwise/ivy.functional.ivy.elementwise.multiply.html#ivy.multiply" title="ivy.multiply"><code class="xref py py-func docutils literal notranslate"><span class="pre">ivy.multiply()</span></code></a> and <a class="reference internal" href="../../docs/functional/ivy/elementwise/ivy.functional.ivy.elementwise.divide.html#ivy.divide" title="ivy.divide"><code class="xref py py-func docutils literal notranslate"><span class="pre">ivy.divide()</span></code></a> respectively.
However, for some special methods such as <a class="reference external" href="https://github.com/unifyai/ivy/blob/8605c0a50171bb4818d0fb3e426cec874de46baa/ivy/array/__init__.py#L234">__setitem__</a>, there are substantial differences between the backend frameworks which must be addressed in the <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.Array</span></code> implementation.</p>
</section>
<section id="array-handling">
<h2>Array Handling<a class="headerlink" href="#array-handling" title="Link to this heading">#</a></h2>
<p>When calling backend-specific functions such as <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.sin()</span></code>, we must pass in <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.NativeArray</span></code> instances.
For example, <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.sin()</span></code> will throw an error if we try to pass in an <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.Array</span></code> instance.
It must be provided with a <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>, and this is reflected in the <a class="reference external" href="https://github.com/unifyai/ivy/blob/8605c0a50171bb4818d0fb3e426cec874de46baa/ivy/functional/backends/torch/elementwise.py#L219">backend type hints</a>.</p>
<p>However, all Ivy functions must return <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.Array</span></code> instances, which is reflected in the <a class="reference external" href="https://github.com/unifyai/ivy/blob/8605c0a50171bb4818d0fb3e426cec874de46baa/ivy/functional/ivy/elementwise.py#L1342">Ivy type hints</a>.
The reason we always return <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.Array</span></code> instances from Ivy functions is to ensure that any subsequent Ivy code is fully framework-agnostic, with all operators performed on the returned array being handled by the special methods of the <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.Array</span></code> class, and not the special methods of the backend <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.NativeArray</span></code> class.</p>
<p>For example, calling any of (<code class="code docutils literal notranslate"><span class="pre">+</span></code>, <code class="code docutils literal notranslate"><span class="pre">-</span></code>, <code class="code docutils literal notranslate"><span class="pre">*</span></code>, <code class="code docutils literal notranslate"><span class="pre">/</span></code> etc.) on the array will result in (<code class="xref py py-meth docutils literal notranslate"><span class="pre">__add__()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">__sub__()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">__mul__()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">__truediv__()</span></code> etc.) being called on the array class.</p>
<p>For most special methods, calling them on the <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.NativeArray</span></code> would not be a problem because all backends are generally quite consistent, but as explained above, for some functions such as <a class="reference external" href="https://github.com/unifyai/ivy/blob/8605c0a50171bb4818d0fb3e426cec874de46baa/ivy/array/__init__.py#L234">__setitem__</a> there are substantial differences which must be addressed in the <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.Array</span></code> implementation in order to guarantee unified behaviour.</p>
<p>Given that all Ivy functions return <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.Array</span></code> instances, all Ivy functions must also support <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.Array</span></code> instances in the input, otherwise it would be impossible to chain functions together!</p>
<p>Therefore, most functions in Ivy must adopt the following pipeline:</p>
<ol class="arabic simple">
<li><p>convert all <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.Array</span></code> instances in the input arguments to <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.NativeArray</span></code> instances</p></li>
<li><p>call the backend-specific function, passing in these <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.NativeArray</span></code> instances</p></li>
<li><p>convert all of the <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.NativeArray</span></code> instances which are returned from the backend function back into <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.Array</span></code> instances, and return</p></li>
</ol>
<p>Given the repeating nature of these steps, this is all entirely handled in the <a class="reference external" href="https://github.com/unifyai/ivy/blob/1eb841cdf595e2bb269fce084bd50fb79ce01a69/ivy/func_wrapper.py#L149">inputs_to_native_arrays</a> and <a class="reference external" href="https://github.com/unifyai/ivy/blob/1eb841cdf595e2bb269fce084bd50fb79ce01a69/ivy/func_wrapper.py#L209">outputs_to_ivy_arrays</a> wrappers, as explained in the <a class="reference internal" href="function_wrapping.html"><span class="doc">Function Wrapping</span></a> section.</p>
<p>All Ivy functions <em>also</em> accept <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.NativeArray</span></code> instances in the input.
This is for a couple of reasons.
Firstly, <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.Array</span></code> instances must be converted to <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.NativeArray</span></code> instances anyway, and so supporting them in the input is not a problem.
Secondly, this makes it easier to combine backend-specific code with Ivy code, without needing to explicitly wrap any arrays before calling sections of Ivy code.</p>
<p>Therefore, all input arrays to Ivy functions have type <code class="code docutils literal notranslate"><span class="pre">Union[ivy.Array,</span> <span class="pre">ivy.NativeArray]</span></code>, whereas the output arrays have type <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.Array</span></code>.
This is further explained in the <a class="reference internal" href="function_arguments.html"><span class="doc">Function Arguments</span></a> section.</p>
<p>However, <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.NativeArray</span></code> instances are not permitted for the <code class="code docutils literal notranslate"><span class="pre">out</span></code> argument, which is used in most functions.
This is because the <code class="code docutils literal notranslate"><span class="pre">out</span></code> argument dictates the array to which the result should be written, and so it effectively serves the same purpose as the function return.
This is further explained in the <a class="reference internal" href="inplace_updates.html"><span class="doc">Inplace Updates</span></a> section.</p>
<p>As a final point, extra attention is required for <em>compositional</em> functions, as these do not directly defer to a backend implementation.
If the first line of code in a compositional function performs operations on the input array, then this will call the special methods on an <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.NativeArray</span></code> and not on an <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.Array</span></code>.
For the reasons explained above, this would be a problem.</p>
<p>Therefore, all compositional functions have a separate piece of <a class="reference external" href="https://github.com/unifyai/ivy/blob/6a729004c5e0db966412b00aa2fce174482da7dd/ivy/func_wrapper.py#L95">wrapped logic</a> to ensure that all <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.NativeArray</span></code> instances are converted to <code class="xref py py-class docutils literal notranslate"><span class="pre">ivy.Array</span></code> instances before entering into the compositional function.</p>
</section>
<section id="integrating-custom-classes-with-ivy">
<h2>Integrating custom classes with Ivy<a class="headerlink" href="#integrating-custom-classes-with-ivy" title="Link to this heading">#</a></h2>
<p>Ivy’s functional API and its functions can easily be integrated with non-Ivy classes. Whether these classes are ones that inherit from Ivy or completely standalone custom classes, using Ivy’s <code class="code docutils literal notranslate"><span class="pre">__ivy_array_function__</span></code>, Ivy’s functions can handle inputs of those types.</p>
<p>To make use of that feature, the class must contain an implementation for these functions and it must contain an implementation for the function <code class="code docutils literal notranslate"><span class="pre">__ivy_array_function__</span></code>. If a non-Ivy class is passed to an Ivy function, a call to this class’s <code class="code docutils literal notranslate"><span class="pre">__ivy_array_function__</span></code> is made which directs Ivy’s function to handle that input type correctly. This allows users to define custom implementations for any of the functions that can be found in Ivy’s functional API which would further make it easy to integrate those classes with other Ivy projects.</p>
<p><strong>Note</strong>
This functionality is inspired by <a class="reference external" href="https://numpy.org/doc/stable/user/basics.dispatch.html#basics-dispatch">NumPy’s</a> <code class="code docutils literal notranslate"><span class="pre">__ivy_array_function__</span></code> and <a class="reference external" href="https://pytorch.org/docs/stable/notes/extending.html#extending-torch">PyTorch’s</a> <code class="code docutils literal notranslate"><span class="pre">__torch_function__</span></code>.</p>
<p>As an example, consider the following class <code class="code docutils literal notranslate"><span class="pre">MyArray</span></code> with the following definition:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyArray</span><span class="p">:</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
</pre></div>
</div>
<p>Running any of Ivy’s functions using a <code class="code docutils literal notranslate"><span class="pre">MyArray</span></code> object as input will throw an <code class="code docutils literal notranslate"><span class="pre">IvyBackendException</span></code> since Ivy’s functions do not support this class type as input. This is where <code class="code docutils literal notranslate"><span class="pre">__ivy_array_function__</span></code> comes into play. Let’s add the method to our <code class="code docutils literal notranslate"><span class="pre">MyArray</span></code> class to see how it works.</p>
<p>There are different ways to do so. One way is to use a global dict <code class="code docutils literal notranslate"><span class="pre">HANDLED_FUNCTIONS</span></code> which will map Ivy’s functions to the custom variant functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">HANDLED_FUNCTIONS</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">MyArray</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">def</span> <span class="nf">__ivy_array_function__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">types</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">func</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">HANDLED_FUNCTIONS</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">NotImplemented</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="n">MyArray</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">ivy</span><span class="o">.</span><span class="n">NativeArray</span><span class="p">))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">types</span><span class="p">):</span>
                    <span class="k">return</span> <span class="bp">NotImplemented</span>
            <span class="k">return</span> <span class="n">HANDLED_FUNCTIONS</span><span class="p">[</span><span class="n">func</span><span class="p">](</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="code docutils literal notranslate"><span class="pre">__ivy_array_function__</span></code> accepts four parameters: <code class="code docutils literal notranslate"><span class="pre">func</span></code> representing a reference to the array API function being
overridden, <code class="code docutils literal notranslate"><span class="pre">types</span></code> a list of the types of objects implementing <code class="code docutils literal notranslate"><span class="pre">__ivy_array_function__</span></code>, <code class="code docutils literal notranslate"><span class="pre">args</span></code> a tuple of arguments supplied to the function, and <code class="code docutils literal notranslate"><span class="pre">kwargs</span></code> being a dictionary of keyword arguments passed to the function.
While this class contains an implementation for <code class="code docutils literal notranslate"><span class="pre">__ivy_array_function__</span></code>, it is still not enough as it is necessary to implement any needed Ivy functions with the new <code class="code docutils literal notranslate"><span class="pre">MyArray</span></code> class as input(s) for the code to run successfully.
We will define a decorator function <code class="code docutils literal notranslate"><span class="pre">implements</span></code> that can be used to add functions to <code class="code docutils literal notranslate"><span class="pre">HANDLED_FUNCTIONS</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">implements</span><span class="p">(</span><span class="n">ivy_function</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="n">HANDLED_FUNCTIONS</span><span class="p">[</span><span class="n">ivy_function</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
        <span class="k">return</span> <span class="n">func</span>
    <span class="k">return</span> <span class="n">decorator</span>
</pre></div>
</div>
<p>Lastly, we need to apply that decorator to the override function. Let’s consider for example a function that overrides <code class="code docutils literal notranslate"><span class="pre">ivy.abs</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@implements</span><span class="p">(</span><span class="n">ivy</span><span class="o">.</span><span class="n">abs</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_abs</span><span class="p">(</span><span class="n">my_array</span><span class="p">,</span> <span class="n">ivy_array</span><span class="p">):</span>
    <span class="n">my_array</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">my_array</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>Now that we have added the function to <code class="code docutils literal notranslate"><span class="pre">HANDLED_FUNCTIONS</span></code>, we can now use <code class="code docutils literal notranslate"><span class="pre">ivy.abs</span></code> with <code class="code docutils literal notranslate"><span class="pre">MyArray</span></code> objects:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">MyArray</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">ivy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
<p>Of course <code class="code docutils literal notranslate"><span class="pre">ivy.abs</span></code> is an example of a function that is easy to override since it only requires one operand. The same approach can be used to override functions with multiple operands, including arrays or array-like objects that define <code class="code docutils literal notranslate"><span class="pre">__ivy_array_function__</span></code>.</p>
<p>It is relevant to mention again that any function not stored inside the dict <code class="code docutils literal notranslate"><span class="pre">HANDLED_FUNCTIONS</span></code> will not work and it is also important to notice that the operands passed to the function must match that of the function stored in the dict. For instance <code class="code docutils literal notranslate"><span class="pre">my_abs</span></code> takes only one parameter which is a <code class="code docutils literal notranslate"><span class="pre">MyArray</span></code> object. So, passing any other operands to the function will result in an exception <code class="code docutils literal notranslate"><span class="pre">IvyBackendException</span></code> being thrown. Lastly, for a custom class to be covered completely with Ivy’s functional API, it is necessary to create an implementation for all the relevant functions within the API that will be used by this custom class. That can be all the functions in the API or only a subset of them.</p>
<p><strong>Round Up</strong></p>
<p>This should have hopefully given you a good feel for the different types of arrays, and how these are handled in Ivy.</p>
<p>If you have any questions, please feel free to reach out on <a class="reference external" href="https://discord.gg/sXyFF8tDtm">discord</a> in the <a class="reference external" href="https://discord.com/channels/799879767196958751/1189905906905919609">arrays thread</a>!</p>
<p><strong>Video</strong></p>
<iframe width="420" height="315" allow="fullscreen;"
src="https://www.youtube.com/embed/tAlDPnWcLDE" class="video">
</iframe></section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="backend_setting.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Backend Setting</p>
      </div>
    </a>
    <a class="right-next"
       href="containers.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Containers</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#native-array">Native Array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ivy-array">Ivy Array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#array-handling">Array Handling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integrating-custom-classes-with-ivy">Integrating custom classes with Ivy</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Transpile AI.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>